<template>
  <div class="per_report">
    <div class="report_search">
      <div class="search1" style="padding-bottom: 6px">
        <!-- <div class="div1">
          <span class="span1">å•ä½ä»£ç ï¼š</span>
          <el-input
            style="width: 120px"
            v-model="searchParams.unitCode"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div>
        <div class="div1">
          <span class="span1">æ¬¡æ•°ï¼š</span>
          <el-input
            style="width: 100px"
            v-model="searchParams.unitVisitId"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div> -->
        <!-- <div class="div1">
          <el-button @click="search">æŸ¥è¯¢</el-button>
        </div> -->
        <div class="div1">
          <span class="span1">é¢„çº¦æ—¶é—´åŒºé—´ï¼š</span>
          <el-date-picker
            v-model="time"
            format="YYYY-MM-DD"
            value-format="YYYY-MM-DD"
            type="daterange"
            start-placeholder="å¼€å§‹æ—¥æœŸ"
            end-placeholder="ç»“æŸæ—¥æœŸ"
            class="!w-230px"
            @change="search"
          />
        </div>

        <div class="div1">
          <span class="span1">ä½“æ£€å·ï¼š</span>
          <el-input
            style="width: 120px; margin-right: 12px"
            v-model="searchParams.peId"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div>
        <div class="div1">
          <span class="span1">æ¬¡æ•°ï¼š</span>
          <el-input
            style="width: 64px"
            v-model="searchParams.peVisitId"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div>
        <!-- <div class="div1">
          <el-button>æŸ¥è¯¢</el-button>
        </div> -->
        <div class="div1">
          <span class="span1">å§“åï¼š</span>
          <el-input
            style="width: 120px"
            v-model="searchParams.name"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div>
        <div class="div1">
          <span class="span1 !w-70px" style="text-align: right">èº«ä»½è¯ï¼š</span>
          <el-input
            style="width: 180px"
            v-model="searchParams.idNo"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div>
        <!-- <div class="div1">
          <span class="span1">ç”µè¯ï¼š</span>
          <el-input
            style="width: 130px"
            v-model="searchParams.number"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div> -->

        <!-- <div class="div1">
          <el-button @click="search">æŸ¥è¯¢</el-button>
        </div> -->

        <!-- <div class="div1">
          <span class="span1">å©šæ£€ç¼–ç ï¼š</span>
          <el-input
            style="width: 120px"
            v-model="searchParams.premaritalCode"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div> -->
        <!-- <div class="div1">
          <span class="span1">ä¸¤ç™Œç¼–ç ï¼š</span>
          <el-input
            style="width: 120px"
            v-model="searchParams.screeningCode"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div> -->
        <div class="div1">
          <span>
            <!-- <b style="color: #ed2226">*</b> -->
            ä½“æ£€ç±»å‹ï¼š</span
          >
          <el-select
            v-model="searchParams.peTypeName"
            placeholder="ä½“æ£€ç±»å‹"
            style="width: 120px"
            class="select-item"
            filterable
            clearable
            default-first-option
            @change="changePeType(searchParams.peTypeName)"
          >
            <el-option
              v-for="item in petypeNameList"
              :key="item.keyCode"
              :label="item.keyValue"
              :value="item.keyValue"
            />
          </el-select>
        </div>
        <div class="div1">
          <el-button @click="search">æŸ¥è¯¢</el-button>
        </div>
      </div>
      <div class="search1" style="padding-bottom: 6px">
        <div class="div1">
          <span class="span1">å•ä½åç§°ï¼š</span>
          <el-input
            style="width: 120px"
            v-model="searchParams.unitName"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
          <span class="selectBtn">
            <el-button :icon="Search" @click="onFocusUnitCode()" />
          </span>
        </div>
        <div class="div1">
          <span class="span1">å•ä½ä»£ç ï¼š</span>
          <el-input
            style="width: 120px"
            v-model="searchParams.unitCode"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div>
        <div class="div1">
          <span class="span1">å•ä½æ¬¡æ•°ï¼š</span>
          <el-input
            style="width: 64px"
            v-model="searchParams.unitVisitId"
            placeholder="è¯·è¾“å…¥"
            class="select-item"
            clearable
            @change="search"
          />
        </div>
        <div class="div1">
          <span class="span1">æ‰“å°å†…å®¹ï¼š</span>
          <el-checkbox @change="printType1" v-model="guidanceSheet" label="æŒ‡å¼•å•" size="large" />
        </div>
        <!-- <div class="div1">
          <el-input-number
            v-model="num"
            :min="1"
            :max="10"
            class="!w-98px"
            controls-position="right"
          />
        </div> -->
        <div class="div1">
          <!-- <el-checkbox
            @change="printType2"
            v-model="printParams.labSheetTag"
            label="æ£€éªŒç”³è¯·å•"
            size="large"
          />
          <el-checkbox
            @change="printType3"
            v-model="printParams.personTag"
            label="äººå‘˜æ¡å½¢ç "
            size="large"
          /> -->
        </div>
        <!-- <div class="div1">
          <el-input-number
            v-model="num"
            :min="1"
            :max="10"
            class="!w-98px"
            controls-position="right"
          />
        </div> -->
        <div class="div1">
          <!-- <el-checkbox
            @change="printType4"
            v-model="printParams.labTag"
            label="æ£€éªŒæ¡ç "
            size="large"
          />
          <el-checkbox
            @change="printType5"
            v-model="printParams.examSheetTag"
            label="æ£€æŸ¥ç”³è¯·å•"
            size="large"
          /> -->
          <!-- <el-checkbox
            @change="printType6"
            v-model="medicalCertificate"
            label="å¥åº·è¯æ˜"
            size="large"
          /> -->
        </div>
        <div class="div1">
          <el-button class="read" @click="print"> <img :src="dayin" />æ‰“å° </el-button>
          <!-- <el-button class="read" @click="uploadPdf"
            ><el-icon><Upload /></el-icon>ä¸Šä¼ å¥åº·è¯æ˜PDF</el-button
          > -->
          <!-- <el-button type="primary" @click="beginSign">å¼€å§‹ç­¾å</el-button> -->
          <!-- <img
            v-if="SignUrl && SignUrl.length > 0"
            style="height: 40px; margin-left: 10px; border: 1px solid #eee"
            :src="SignUrl"
            alt="ç­¾åå›¾ç‰‡"
          /> -->
        </div>
      </div>
      <!-- <div class="search1" style="padding-top: 6px">
        
      </div> -->
    </div>
    <div class="report_table">
      <div class="table_item">
        <div class="list_table">
          <!-- <el-checkbox-group v-model="multipleSelectionArr" @change="handleSelectionChange">
            <el-checkbox
              v-for="(item, index) in tableData"
              :key="index"
              :label="item.uniqueId || `${item.peId}_${item.peVisitId}`"
            >
              <span style="padding-right: 12px">{{ item.peId }}-{{ item.peVisitId }}</span>
              <span>{{ item.name }}</span>
            </el-checkbox>
          </el-checkbox-group> -->
          <el-table
            :data="tableData"
            style="width: 100%"
            height="calc(100vh - 262px)"
            border
            @selection-change="handleSelectionChange"
            ref="multipleTableRef"
            @row-click="handleRowClick"
            highlight-current-row
          >
            <el-table-column type="selection" align="center" width="60" />
            <el-table-column
              v-for="item in personList"
              :key="item.prop"
              :label="item.label"
              :prop="item.prop"
              :align="item.align"
              :width="item.width"
              show-overflow-tooltip
            >
            </el-table-column>
          </el-table>
          <div style="width: 190px; height: 20px; font-size: 20px; color: #666"
            >åˆè®¡ï¼š{{ tableData.length || '0' }} äºº</div
          >
        </div>
      </div>
    </div>
    <!-- <div id="printMe" :style="tableData.length > 0 ? 'display:block;' : 'display:none;'"> -->
    <div id="printMe">
      <div class="print_content" v-for="(perItem, perIndex) in mediaPrintData" :key="perIndex">
        <div class="print_heard">
          <div class="hos_t">
            <div>åŒ—æˆ´æ²³ç–—å…»ä¸­å¿ƒ</div>
            <img :src="perItem.peVisitListRespVo.imgUrl" />
          </div>
          <div class="title">ä½“æ£€æŒ‡å¼•å•</div>
          <div class="per_msg">
            <el-row>
              <el-col :span="4">å§“åï¼š{{ perItem.peVisitListRespVo.name }}</el-col>
              <el-col :span="6"
                >æ€§åˆ«ï¼š{{
                  perItem.peVisitListRespVo.sex ? perItem.peVisitListRespVo.sex : ''
                }}</el-col
              >
              <el-col :span="5">å¹´é¾„ï¼š{{ perItem.peVisitListRespVo.age }}</el-col>
              <el-col :span="5">å©šå§»ï¼š{{ perItem.peVisitListRespVo.maritalStatus }}</el-col>
            </el-row>
            <el-row>
              <el-col :span="4"
                >ä½“æ£€æ€§è´¨ï¼š{{
                  perItem.peVisitListRespVo.chargeType ? perItem.peVisitListRespVo.chargeType : ''
                }}</el-col
              >
              <el-col style="white-space: nowrap; overflow: hidden" :span="6"
                >ä½“æ£€ç±»å‹ï¼š{{
                  perItem.peVisitListRespVo.peTypeName ? perItem.peVisitListRespVo.peTypeName : ''
                }}</el-col
              >
              <el-col :span="5"
                >ä½“æ£€æ—¥æœŸï¼š{{
                  perItem.peVisitListRespVo.pePreDate
                    ? formatDate(perItem.peVisitListRespVo.pePreDate, 'YYYY-MM-DD')
                    : ''
                }}</el-col
              >
              <el-col :span="5"
                >ä½“æ£€æ¬¡æ•°ï¼š{{
                  perItem.peVisitListRespVo.peVisitId ? perItem.peVisitListRespVo.peVisitId : ''
                }}</el-col
              >
              <!-- <el-col :span="5">å²—ä½ï¼šæš‚æ— </el-col> -->
            </el-row>
            <el-row>
              <!-- <el-col :span="6"
      >ä½“æ£€æ—¥æœŸï¼š{{
        perItem.peVisitListRespVo.pePreDate
          ? formatDate(perItem.peVisitListRespVo.pePreDate, 'YYYY-MM-DD')
          : ''
      }}</el-col
    > -->
              <el-col :span="4">ä¼˜å…ˆçº§ï¼š{{ perItem.peVisitListRespVo.peLevel }}</el-col>
              <el-col :span="7">ä½“æ£€å¥—é¤ï¼š{{ perItem.peVisitListRespVo.setCode }}</el-col>
              <el-col :span="9"
                >ä½“æ£€å•ä½ï¼š{{
                  perItem.peVisitListRespVo.unitname ? perItem.peVisitListRespVo.unitname : ''
                }}</el-col
              >
            </el-row>
            <!-- ä½¿ç”¨ç»å¯¹å®šä½æ”¾ç½®å›¾ç‰‡ï¼Œé¿å…å½±å“å…¶ä»–å…ƒç´ å¸ƒå±€ -->
            <div style="position: absolute; right: 60px; top: -25px; width: 80px">
              <div style="margin-bottom: 5px">
                <img
                  v-if="perItem.peVisitListRespVo.photo"
                  :src="perItem.peVisitListRespVo.photo"
                  style="width: 100%; height: auto; display: block"
                  alt="ä¸ªäººç…§ç‰‡"
                />
              </div>
            </div>

            <div style="position: absolute; right: 20px; top: 73px; width: 160px">
              <img
                :src="perItem.peVisitListRespVo.HisImgUrl"
                style="width: 100%; height: auto"
                alt="æ¡å½¢ç "
              />
            </div>
          </div>
          <div class="tishi">
            <div class="tishi_in">
              <div class="tishi_t" style="width: 55px">æ¸©é¦¨<br />æç¤º</div>
              <div class="tishi_con" style="width: calc(100% - 55px)">
                <div v-if="perItem.peVisitListRespVo.kindReminder">
                  <div v-if="perItem.peVisitListRespVo.kindReminderList.length > 0">
                    <el-row
                      v-for="(kindMsg, kindIndex) in perItem.peVisitListRespVo.kindReminderList"
                      :key="kindIndex"
                    >
                      <el-col :span="24">
                        {{ kindMsg }}
                      </el-col>
                    </el-row>
                  </div>
                  <div v-else>
                    <el-row>
                      <el-col :span="24">
                        {{ perItem.peVisitListRespVo.kindReminder }}
                      </el-col>
                    </el-row>
                  </div>
                </div>
                <div v-else>
                  <el-row>
                    <el-col :span="24">* å‘¼æ°”è¯•éªŒã€æŠ½è¡€è¶…å£°ç­‰é¡¹ç›®è¯·ç©ºè…¹ï¼ŒæŠ½è¡€åè¯·æŒ‰å‹5åˆ†é’Ÿ</el-col>
                  </el-row>
                  <el-row>
                    <el-col :span="24"
                      >*
                      å­•æœŸï¼Œå“ºä¹³æœŸï¼Œå¤‡å­•(åŠå¹´å†…ï¼ŒåŒ…æ‹¬ç”·å£«)è¯·å‹¿åšXçº¿æ£€æŸ¥ã€‚æ³Œå°¿ç³»ï¼Œç»è…¹å¦‡ç§‘å½©è¶…è¯·å…ˆæ†‹å°¿ï¼Œæœªå©šå¥³æ€§è¯·å‹¿åšå¦‡ç§‘æ£€æŸ¥</el-col
                    >
                  </el-row>
                  <el-row>
                    <el-col :span="24"
                      >* ä½“æ£€å®Œæˆï¼Œè¯·æŠŠæœ¬æŒ‡å¼•å•äº¤å›å‰å°ï¼Œä»¥å…å½±å“æ‚¨çš„ä½“æ£€æŠ¥å‘Šçš„å‘æ”¾</el-col
                    >
                  </el-row>
                </div>
              </div>
            </div>
            <div class="tishi_in" style="border-bottom: none">
              <div class="tishi_t" style="width: 80px"
                ><span
                  style="
                    display: inline-block;
                    width: 12px;
                    height: 12px;
                    border: #333333 1px solid;
                    margin-right: 5px;
                  "
                ></span
                >ä¸€èˆ¬æƒ…å†µ</div
              >
              <div class="tishi_con">
                <el-row style="line-height: 26px; height: 26px">
                  <el-col :span="5"
                    >èº«é«˜ï¼š&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cm</el-col
                  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  <el-col :span="5"
                    >ä½“é‡ï¼š&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kg</el-col
                  >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                  <el-col :span="6"
                    >è¡€å‹ï¼š&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mmHg</el-col
                  >
                </el-row>
              </div>
            </div>
            <div
              class="tishi_in"
              v-if="perItem.peVisitListRespVo.sumCharges"
              style="border-top: none"
            >
              <div class="tishi_t" style="font-weight: normal; text-align: right; width: 80px"
                >ä½“æ£€è´¹</div
              >
              <div class="tishi_con">
                <el-row>
                  <el-col :span="24"
                    >{{ perItem.peVisitListRespVo.sumCharges }}å…ƒ
                    <span v-if="perItem.peVisitListRespVo.otherCosts"
                      >ï¼ˆè€—æé‡‘é¢&nbsp;&nbsp;{{ perItem.peVisitListRespVo.otherCosts }}å…ƒï¼‰</span
                    >
                  </el-col>
                </el-row>
              </div>
            </div>
          </div>
        </div>
        <div class="print_con">
          <div class="table">
            <div class="table_t">
              <el-row>
                <el-col :span="3">æ£€æŸ¥å•æ¡ç </el-col>
                <el-col :span="1">åºå·</el-col>
                <el-col :span="10">ä½“æ£€é¡¹ç›®</el-col>
                <el-col :span="2">æ‹’æ£€ç­¾å­—</el-col>
                <el-col :span="8" style="text-align: center">æç¤ºä¿¡æ¯</el-col>
              </el-row>
              <div v-for="(item, index) in perItem.noJiaxiangList" :key="index" class="neirong">
                <el-row>
                  <el-col :span="3"
                    ><img
                      :style="item.imgUrl ? '' : 'display:none'"
                      style="width: 100%; height: 32px; line-height: 36px"
                      :src="item.imgUrl"
                      alt=""
                  /></el-col>
                  <el-col :span="1">{{ index + 1 }}</el-col>
                  <el-col :span="10"
                    >{{ item.assemName
                    }}{{ item.charges ? 'ï¼ˆ' + item.charges + 'å…ƒï¼‰' : '' }}</el-col
                  >
                  <el-col :span="2">{{}}</el-col>
                  <el-col
                    :class="item.chartGuide && item.chartGuide.length > 18 ? col_LH : ''"
                    :span="8"
                    >{{ item.chartGuide }}</el-col
                  >
                </el-row>
              </div>
              <div class="neirong" v-if="perItem.jiaxiangList && perItem.jiaxiangList.length > 0">
                <el-row>
                  <el-col :span="3"></el-col>
                  <el-col :span="1"><span style="font-weight: bold">åŠ é¡¹</span></el-col>
                  <el-col :span="10"></el-col>
                  <el-col :span="2"></el-col>
                  <el-col :span="8"></el-col>
                </el-row>
              </div>
              <div v-for="(item, index) in perItem.jiaxiangList" :key="index" class="neirong">
                <el-row>
                  <el-col :span="3"
                    ><img
                      :style="item.imgUrl ? '' : 'display:none'"
                      style="width: 100%; height: 32px; line-height: 36px"
                      :src="item.imgUrl"
                      alt=""
                  /></el-col>
                  <el-col :span="1">{{ index + 1 }}</el-col>
                  <el-col :span="10">{{ item.assemName }}</el-col>
                  <el-col :span="2">{{}}</el-col>
                  <el-col
                    :class="item.chartGuide && item.chartGuide.length > 18 ? col_LH : ''"
                    :span="8"
                    >{{ item.chartGuide }}</el-col
                  >
                </el-row>
              </div>
            </div>
          </div>
          <div class="b_msg">
            <div class="tishi_in">
              <div class="tishi_t" style="width: 310px; display: flex">
                å—æ£€è€…ç¡®è®¤ç­¾å­—ï¼š
                <img
                  v-if="perItem.peVisitListRespVo.signValueString"
                  style="height: 56px; display: inlineblock; transform: translateY(-30%)"
                  :src="perItem.peVisitListRespVo.signValueString"
                  alt="ç­¾åå›¾ç‰‡"
                />
              </div>
            </div>
            <div class="b_c">
              æ¸©é¦¨æç¤º:å¦‚æœæ‚¨å¤„åœ¨å­•æœŸæˆ–è¿‘æœŸæœ‰æ€€å­•è®¡åˆ’ï¼Œè¯·ä¸è¦åšæ”¾å°„æ€§æ£€æŸ¥(å¦‚:Xçº¿ï¼ŒCTç­‰)
            </div>
            <!-- <div class="b_p">ç¬¬{{ index + 1 }}é¡µ/å…±{{ perItem.length }}é¡µ</div> -->
          </div>
          <!-- <div class="bot">
            <div class="bot_l">ä½“æ£€æŠ¥å‘Š<br />é¢†å–å‡­æ¡</div>
            <div class="bot_r">
              <el-row>
                <el-col :span="6">ä½“æ£€å·ï¼š{{ item[1].peId ? item[1].peId : '' }}</el-col>
                <el-col :span="6">å§“åï¼š{{ item[1].name ? item[1].name : '' }}</el-col>
                <el-col :span="6">æ€§åˆ«ï¼š{{ item[1].sex ? item[1].sex : '' }}</el-col>
                <el-col :span="6">å¹´é¾„ï¼š{{ item[1].age ? item[1].age : '' }}</el-col>
              </el-row>
              <el-row>
                <el-col :span="12">å·¥ä½œå•ä½ï¼š{{ item[1].unitName ? item[1].unitName : '' }}</el-col>
                <el-col :span="12"
                  >ä½“æ£€æ—¥æœŸï¼š{{
                    item[1].peQueueDate ? formatDate(item[1].peQueueDate, 'YYYY-MM-DD') : ''
                  }}</el-col
                >
              </el-row>
              <el-row>
                <el-col :span="12"></el-col>
                <el-col :span="12"
                  >è”ç³»ç”µè¯ï¼š{{ item[1].phoneNumber ? item[1].phoneNumber : '' }}</el-col
                >
              </el-row>
            </div>
          </div> -->
        </div>
      </div>
    </div>
    <div id="health" ref="examSheet">
      <div class="health_page page">
        <div class="health_h">
          <div class="h_div1">è”å‹¤ä¿éšœéƒ¨é˜ŸåŒ—æˆ´æ²³ç–—å…»ä¸­å¿ƒ</div>
          <div class="h_div2">ä½“æ£€ç¼–å·ï¼š{{ healthTabelData.healthExaminationId }}</div>
        </div>
        <div class="health_t">åŒ—äº¬å¸‚ä»ä¸šäººå‘˜å¥åº·è¯æ˜</div>
        <div class="health_i">ç›´æ¥æ¥è§¦å…¥å£é£Ÿå“äººå‘˜</div>
        <div class="health_per">
          <div class="per_yb">ä¸€èˆ¬æƒ…å†µ</div>
          <div class="per_na">
            <div class="div1">å§“å</div>
            <div class="div2">{{ healthTabelData.name }}</div>
            <div class="div3">æ€§åˆ«</div>
            <div class="div4">{{ healthTabelData.genderName }}</div>
            <img :src="healthTabelData.photo" />
          </div>
          <div class="per_sfz">
            <div class="div1">èº«ä»½è¯å·</div>
            <div class="div2">{{ healthTabelData.identifierValue }}</div>
          </div>
          <div class="per_jk">å¥åº·æ£€æŸ¥ä¿¡æ¯</div>
        </div>
        <div class="div_table">
          <table class="data_table">
            <tr class="tr1">
              <td rowspan="2" class="td1">ç–¾ç—…åç§°</td>
              <td colspan="3" class="td2">æ£€æŸ¥ç»“æœ</td>
              <td rowspan="2" class="td3">åŒ»å¸ˆ<br />ç­¾ç« </td>
              <td rowspan="2" class="td4">æ£€æŸ¥æ—¥æœŸ</td>
            </tr>
            <tr class="tr2">
              <td class="td1">æ— </td>
              <td class="td2">æœ‰</td>
              <td class="td3">å¤‡æ³¨</td>
            </tr>
            <tr
              class="tr3"
              v-if="
                healthTabelData.hasBacterialDysentery == '1' ||
                healthTabelData.hasBacterialDysentery == '2'
              "
            >
              <td class="td1">ç»†èŒæ€§ç—¢ç–¾</td>
              <td class="td2">{{ healthTabelData.hasBacterialDysentery == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.hasBacterialDysentery == '1' ? 'âœ“' : '' }}</td>
              <td class="td4">{{ healthTabelData.bacterialDysenteryNote }}</td>
              <td class="td5">
                <!-- <img :src="healthTabelData.bacterialDysenteryPractitionerName" /> -->
                <!-- {{ healthTabelData.bacterialDysenteryPractitionerName }} -->
                æ±¤é¹ç²
              </td>
              <td class="td6">{{ healthTabelData.bacterialDysenteryDate }}</td>
            </tr>
            <tr
              class="tr3"
              v-if="healthTabelData.hasTyphoid == '1' || healthTabelData.hasTyphoid == '2'"
            >
              <td class="td1">ä¼¤å¯’å’Œå‰¯ä¼¤å¯’</td>
              <td class="td2">{{ healthTabelData.hasTyphoid == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.hasTyphoid == '1' ? 'âœ“' : '' }}</td>
              <td class="td4">{{ healthTabelData.typhoidNote }}</td>
              <td class="td5">
                <!-- <img :src="healthTabelData.typhoidPractitionerName" /> -->
                <!-- {{ healthTabelData.typhoidPractitionerName }} -->
                æ±¤é¹ç²
              </td>
              <td class="td6">{{ healthTabelData.typhoidDate }}</td>
            </tr>
            <tr
              class="tr3"
              v-if="
                healthTabelData.hasViralHepatitis == '1' || healthTabelData.hasViralHepatitis == '2'
              "
            >
              <td class="td1">ç—…æ¯’æ€§è‚ç‚<br />(ç”²å‹ã€æˆŠå‹)</td>
              <td class="td2">{{ healthTabelData.hasViralHepatitis == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.hasViralHepatitis == '1' ? 'âœ“' : '' }}</td>
              <td class="td4">{{ healthTabelData.viralHepatitisNote }}</td>
              <td class="td5">
                <!-- <img :src="healthTabelData.viralHepatitisPractitionerName" /> -->
                <!-- {{ healthTabelData.viralHepatitisPractitionerName }} -->
                æ™¯å»ºç‘œ
              </td>
              <td class="td6">{{ healthTabelData.viralHepatitisDate }}</td>
            </tr>
            <tr
              class="tr3"
              v-if="healthTabelData.hasActiveTB == '1' || healthTabelData.hasActiveTB == '2'"
            >
              <td class="td1">æ´»åŠ¨æ€§è‚ºç»“æ ¸</td>
              <td class="td2">{{ healthTabelData.hasActiveTB == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.hasActiveTB == '1' ? 'âœ“' : '' }}</td>
              <td class="td4">{{ healthTabelData.activeTBNote }}</td>
              <td class="td5">
                <!-- <img :src="healthTabelData.activeTBPractitioner" /> -->
                {{ healthTabelData.activeTBPractitioner }}
              </td>
              <td class="td6">{{ healthTabelData.activeTBDate }}</td>
            </tr>
            <tr
              class="tr3"
              v-if="
                healthTabelData.hasSkinDiseases == '1' || healthTabelData.hasSkinDiseases == '2'
              "
            >
              <td class="td1">åŒ–è„“æ€§æˆ–æ¸—å‡ºæ€§çš®è‚¤ç—…</td>
              <td class="td2">{{ healthTabelData.hasSkinDiseases == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.hasSkinDiseases == '1' ? 'âœ“' : '' }}</td>
              <td class="td4">{{ healthTabelData.skinDiseasesNote }}</td>
              <td class="td5">
                <!-- <img :src="healthTabelData.skinDiseasesPractitionerName" /> -->
                <!-- {{ healthTabelData.skinDiseasesPractitionerName }} -->
                æ¸©å®ä¼Ÿ
              </td>
              <td class="td6">{{ healthTabelData.skinDiseasesDate }}</td>
            </tr>
            <tr
              class="tr3"
              v-if="healthTabelData.hasHandFungal == '1' || healthTabelData.hasHandFungal == '2'"
            >
              <td class="td1">æ‰‹éƒ¨çœŸèŒæ„ŸæŸ“æ€§ç–¾ç—…<br />(å¦‚æ‰‹ç™£ã€æŒ‡ç”²ç™£ç­‰)</td>
              <td class="td2">{{ healthTabelData.hasHandFungal == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.hasHandFungal == '1' ? 'âœ“' : '' }}</td>
              <td class="td4">{{ healthTabelData.handFungalNote }}</td>
              <td class="td5">
                <!-- <img :src="healthTabelData.handFungalPractitionerName" /> -->
                <!-- {{ healthTabelData.handFungalPractitionerName }} -->
                æ¸©å®ä¼Ÿ
              </td>
              <td class="td6">{{ healthTabelData.handFungalDate }}</td>
            </tr>
            <tr
              class="tr3"
              v-if="healthTabelData.hasCholera == '1' || healthTabelData.hasCholera == '2'"
            >
              <td class="td1">éœä¹±</td>
              <td class="td2">{{ healthTabelData.hasCholera == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.hasCholera == '1' ? 'âœ“' : '' }}</td>
              <td class="td4">{{ healthTabelData.choleraNote }}</td>
              <td class="td5">
                <!-- <img :src="healthTabelData.choleraPractitionerName" /> -->
                <!-- {{ healthTabelData.choleraPractitionerName }} -->
                æ±¤é¹ç²
              </td>
              <td class="td6">{{ healthTabelData.choleraTestDate }}</td>
            </tr>
            <tr
              class="tr3"
              v-if="
                healthTabelData.hasAmebicDysentery == '1' ||
                healthTabelData.hasAmebicDysentery == '2'
              "
            >
              <td class="td1">é˜¿ç±³å·´æ€§ç—¢ç–¾</td>
              <td class="td2">{{ healthTabelData.hasAmebicDysentery == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.hasAmebicDysentery == '1' ? 'âœ“' : '' }}</td>
              <td class="td4">{{ healthTabelData.amebicDysenteryNote }}</td>
              <td class="td5">
                <!-- <img :src="healthTabelData.amebicDysenteryPractitionerName" /> -->
                <!-- {{ healthTabelData.amebicDysenteryPractitionerName }} -->
                æ±¤é¹ç²
              </td>
              <td class="td6">{{ healthTabelData.amebicDysenteryDate }}</td>
            </tr>
            <tr
              class="tr3"
              v-if="healthTabelData.hasHandEczema == '1' || healthTabelData.hasHandEczema == '2'"
            >
              <td class="td1">æ‰‹éƒ¨æ¹¿ç–¹</td>
              <td class="td2">{{ healthTabelData.hasHandEczema == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.hasHandEczema == '1' ? 'âœ“' : '' }}</td>
              <td class="td4">{{ healthTabelData.handEczemaNote }}</td>
              <td class="td5">
                <!-- <img :src="healthTabelData.handEczemaPractitionerName" /> -->
                <!-- {{ healthTabelData.handEczemaPractitionerName }} -->
                æ¸©å®ä¼Ÿ
              </td>
              <td class="td6">{{ healthTabelData.handEczemaDate }}</td>
            </tr>
            <tr
              class="tr3"
              v-if="
                healthTabelData.hasHandPsoriasis == '1' || healthTabelData.hasHandPsoriasis == '2'
              "
            >
              <td class="td1">æ‰‹éƒ¨çš„é“¶å±‘ç—…æˆ–è€…é³å±‘</td>
              <td class="td2">{{ healthTabelData.hasHandPsoriasis == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.hasHandPsoriasis == '1' ? 'âœ“' : '' }}</td>
              <td class="td4">{{ healthTabelData.handPsoriasisNote }}</td>
              <td class="td5">
                <!-- <img :src="healthTabelData.handPsoriasisPractitionerName" /> -->
                <!-- {{ healthTabelData.handPsoriasisPractitionerName }} -->
                æ¸©å®ä¼Ÿ
              </td>
              <td class="td6">{{ healthTabelData.handPsoriasisDate }}</td>
            </tr>
            <tr class="tr3" v-if="healthTabelData.bsl == '1' || healthTabelData.bsl == '2'">
              <td class="td1">è¾¨è‰²åŠ›</td>
              <td class="td2">{{ healthTabelData.bsl == '2' ? 'âœ“' : '' }}</td>
              <td class="td3">{{ healthTabelData.bsl == '1' ? 'âœ“' : '' }}</td>
              <td class="td4"></td>
              <td class="td5">
                <!-- <img :src="healthTabelData.bsldoctor" /> -->
                {{ healthTabelData.bsldoctor }}
              </td>
              <td class="td6">{{ healthTabelData.bslDate }}</td>
            </tr>
          </table>
        </div>
        <div class="health_bz"
          >å¤‡æ³¨:æœ¬è¡¨è‡ªä½“æ£€åˆæ ¼(å‘è¡¨)æ—¥èµ·æœ‰æ•ˆæœŸä¸€å¹´ï¼Œæœ¬æ¬¡åŒ–éªŒæ£€æŸ¥ç»“æœï¼Œåªå¯¹æœ¬æ¬¡é€æ£€æ ‡æœ¬è´Ÿè´£ã€‚</div
        >
        <div class="health_qz">
          <div>åŒ»ç–—æœºæ„ï¼š<br />ï¼ˆç›–ç« æœ‰æ•ˆï¼‰</div>
          <div>æ—¥æœŸï¼š{{ healthTabelData.examDate?.split(' ')[0] }}</div>
        </div>
      </div>
    </div>
    <Dialog
      v-model="pdfVisible"
      width="100%"
      top="0vh"
      :fullscreen="true"
      :close-on-click-modal="false"
      class="pdfVisible"
      :modal="false"
      @close="pdfVisible = false"
      :title="'ä½“æ£€æŒ‡å¼•å•å¯¼å‡º'"
    >
      <div>
        <PrintPdf :data="mediaPrintData"></PrintPdf>
      </div>
    </Dialog>
    <img ref="tijianSrc" style="display: none" />
    <img ref="HisSrc" style="display: none" />

    <Dialog
      append-to-body
      v-model="selectUnitCodeVisiable"
      title="å•ä½é€‰æ‹©"
      width="800"
      @close="selectUnitCodeVisiable = false"
      class="package-advice-container"
    >
      <div
        ><el-input
          ref="queryInput"
          class="queryInput !w-300px"
          v-model="keyWord"
          @input="handleQueryItem"
          autofocus="true"
          placeholder="è¯·è¾“å…¥æ‹¼éŸ³ç "
      /></div>
      <el-table
        :data="unitCodeList"
        border
        style="width: 100%; margin-top: 10px; height: 500px"
        highlight-current-row
        @row-dblclick="selectUnitCodeClick"
        ><el-table-column
          :resizable="false"
          align="center"
          label="å•ä½ä»£ç "
          show-overflow-tooltip
          prop="unitCode"
          width="100" /><el-table-column
          :resizable="false"
          align="left"
          label="å•ä½åç§°"
          show-overflow-tooltip
          prop="unitName" /><el-table-column
          :resizable="false"
          align="center"
          label="è”ç³»äºº"
          width="100"
          show-overflow-tooltip
          prop="connecter" /><el-table-column
          :resizable="false"
          align="center"
          label="è”ç³»ç”µè¯"
          width="120"
          show-overflow-tooltip
          prop="phone" /><el-table-column
          :resizable="false"
          align="left"
          label="åœ°å€"
          width="140"
          show-overflow-tooltip
          prop="address" /><el-table-column
          :resizable="false"
          align="center"
          label="æ‹¼éŸ³ç "
          width="100"
          show-overflow-tooltip
          prop="inputCode"
      /></el-table>
    </Dialog>
  </div>
</template>
<script setup lang="ts">
import { VuePrintNext } from 'vue-print-next'
import readCard from '@/assets/images/readCard.svg'
import report from '@/assets/images/report.svg'
import dayin from '@/assets/images/dayin.svg'
import noReport from '@/assets/images/noReport.svg'
import JsBarcode from 'jsbarcode'
import {
  selectPeGuidSheetList,
  selectPeGuidSheetPrint,
  printLabSheet,
  printPersonalBar,
  printBarCode,
  printExamSheet,
  healthCertificateInfo,
  healthCertificateInfoUpload,
  upPdfEmployees,
  peSign
} from '@/api/PerPhyExamination/printGuidanceSheet/index'
import { formatDate } from '@/utils/formatTime'
import PrintPdf from './printPdf.vue'
import { ElLoading, ElMessage } from 'element-plus'
import html2Canvas from 'html2canvas'
import JsPDF from 'jspdf'
import printJS from 'print-js'
import { queryDictByConfig, getPeUnitList } from '@/api/PerPhyExamination/perExamination/index'
import { Search } from '@element-plus/icons-vue'

const tijianSrc = ref<HTMLImageElement | null>(null)
const HisSrc = ref<HTMLImageElement | null>(null)
const searchParams = ref({
  preBeginDate: '',
  preEndDate: '',
  unitName: '',
  unitCode: '',
  unitVisitId: '',
  peId: '',
  peVisitId: '',
  idNo: '',
  number: '',
  name: '',
  peTypeName: ''
})
const pdfVisible = ref(false)
const printParams = ref({
  peVisitReqVoList: [],
  labTag: false,
  personTag: false,
  labSheetTag: false,
  examSheetTag: false
})
const time = ref([formatDate(new Date(), 'YYYY-MM-DD'), formatDate(new Date(), 'YYYY-MM-DD')])
const personList = ref([
  {
    label: 'ä½“æ£€ç±»å‹',
    prop: 'peTypeName',
    align: 'center',
    width: '180'
  },
  {
    label: 'å¥—é¤åç§°',
    prop: 'setName',
    align: 'center',
    width: ''
  },
  {
    label: 'ä½“æ£€å·',
    prop: 'peId',
    align: 'center',
    width: 120
  },
  {
    label: 'å§“å',
    prop: 'name',
    align: 'center',
    width: 120
  },
  {
    label: 'ä½“æ£€æ¬¡æ•°',
    prop: 'peVisitId',
    align: 'center',
    width: 90
  },
  {
    label: 'æ€§åˆ«',
    prop: 'sex',
    align: 'center',
    width: 60
  },
  {
    label: 'å¹´é¾„',
    prop: 'age',
    align: 'center',
    width: 60
  },
  {
    label: 'èº«ä»½è¯å·',
    prop: 'idNo',
    align: 'center',
    width: ''
  },
  {
    label: 'å©šå§»çŠ¶å†µ',
    prop: 'maritalStatus',
    align: 'center',
    width: 100
  },
  {
    label: 'å‡ºç”Ÿæ—¥æœŸ',
    prop: 'dateOfBirth',
    align: 'center',
    width: 140
  },
  {
    label: 'è”ç³»ç”µè¯',
    prop: 'phoneNumber',
    align: 'center',
    width: 120
  },
  {
    label: 'å›¢æ£€å•ä½',
    prop: 'unitname',
    align: 'center',
    width: 160
  }
  // {
  //   label: 'ä¸¤ç™Œç¼–ç ',
  //   prop: 'screeningCode',
  //   align: 'center',
  //   width: 120
  // },
  // {
  //   label: 'å©šæ£€ç¼–ç ',
  //   prop: 'premaritalCode',
  //   align: 'center',
  //   width: 120
  // }
])
const guidanceSheet = ref(true)
const multipleTableRef = ref<TableInstance>()
const multipleSelection = ref<User[]>([])
const multipleSelectionArr = ref<User[]>([])
const deleteRow = (index: number) => {}
const handleSelectionChange = (val: User[]) => {
  multipleSelection.value = val
  // multipleSelectionArr.value = val
  // if (!val || val.length === 0) {
  //   multipleSelection.value = []
  //   return
  // }
  // // è§£æé€‰ä¸­çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œæ‰¾åˆ°å¯¹åº”çš„å®Œæ•´æ•°æ®é¡¹
  // multipleSelection.value = tableData.value.filter((item) => {
  //   const uniqueId = `${item.peId}-${item.peVisitId}`
  //   return val.includes(uniqueId)
  // })

  console.log(multipleSelection.value, 'multipleSelection')
}
const num = ref(1)

// watch(time, (newValue) => {})
const delReport = () => {}
const printType1 = () => {
  if (guidanceSheet.value) {
    printParams.value.labTag = false
    printParams.value.personTag = false
    printParams.value.labSheetTag = false
    printParams.value.examSheetTag = false
    medicalCertificate.value = false
  }
}
const printType2 = () => {
  if (printParams.value.labSheetTag) {
    guidanceSheet.value = false
    printParams.value.labTag = false
    printParams.value.personTag = false
    printParams.value.examSheetTag = false
    medicalCertificate.value = false
  }
}
const printType3 = () => {
  if (printParams.value.personTag) {
    guidanceSheet.value = false
    printParams.value.labTag = false
    printParams.value.labSheetTag = false
    printParams.value.examSheetTag = false
    medicalCertificate.value = false
  }
}
const printType4 = () => {
  if (printParams.value.labTag) {
    guidanceSheet.value = false
    printParams.value.personTag = false
    printParams.value.labSheetTag = false
    printParams.value.examSheetTag = false
    medicalCertificate.value = false
  }
}
const printType5 = () => {
  if (printParams.value.examSheetTag) {
    guidanceSheet.value = false
    printParams.value.labTag = false
    printParams.value.personTag = false
    printParams.value.labSheetTag = false
    medicalCertificate.value = false
  }
}
const medicalCertificate = ref(false)
const printType6 = () => {
  if (medicalCertificate.value) {
    guidanceSheet.value = false
    printParams.value.labTag = false
    printParams.value.personTag = false
    printParams.value.labSheetTag = false
    printParams.value.examSheetTag = false
  }
}
const printMe = ref()
const mediaPrintData = ref([])
const exportPdf = () => {
  if (multipleSelection.value.length > 0) {
    printParams.value.peVisitReqVoList = multipleSelection.value
    let otherPrintParams = {
      flag: 0,
      peVisitReqVoList: multipleSelection.value
    }
    mediaPrintData.value = []
    let printData = []
    if (guidanceSheet.value) {
      // æŒ‡å¼•å•æ‰“å°
      selectPeGuidSheetPrint(printParams.value).then((res) => {
        // console.log(res, 'æŒ‡å¼•å•æ‰“å°æ•°æ®')
        if (res && res.length > 0) {
          printData = res
          if (printData.length > 0) {
            // zhiyindan
            mediaPrintData.value = jsonTo3DArray(printData, 26)
            console.log(mediaPrintData.value, 'æŒ‡å¼•å•æ‰“å°æ•°æ®')
            nextTick(() => {
              pdfVisible.value = true
            })
          }
        }
      })
    }
  }
}
const PrintZhiYinDan = (params = {}) => {
  let printData = []
  selectPeGuidSheetPrint({
    peVisitReqVoList: [
      {
        peId: params.peId || '',
        // peId: 'TJ10000015',
        peVisitId: params.peVisitId || 1,
        peDeptClass: params.peDeptClass || '',
        applyNo: '',
        applyNoList: []
      }
    ],
    labTag: false,
    personTag: false,
    labSheetTag: false,
    examSheetTag: false
  }).then((res) => {
    console.log(res, 'æŒ‡å¼•å•æ‰“å°æ•°æ®')
    if (res && res.length > 0) {
      printData = res
      if (printData.length > 0) {
        // zhiyindan
        // mediaPrintData.value = jsonTo3DArray(printData, 20)
        let jiaxiangList = []
        let noJiaxiangList = []

        printData.forEach((item) => {
          // æ‰‹å†™ç”µå­ç­¾å
          /*  if (item.peVisitListRespVo.signValueString) {
            item.peVisitListRespVo.signValueString =
              'data:image/png;base64,' + item.peVisitListRespVo.signValueString
            console.log(
              '%c Line:822 ğŸ‘ æ‰‹å†™ç”µå­ç­¾å',
              'color:#7f2b82',
              item.peVisitListRespVo.signValueString
            )
          } */
          // PeIdæ¡å½¢ç 
          JsBarcode(tijianSrc.value, item.peVisitListRespVo.peId, {
            // displayValue: false,
            fontSize: 18,
            width: 2,
            height: 30,
            margin: 4
          })
          item.peVisitListRespVo.imgUrl = tijianSrc.value?.src || ''

          // HISæ‚£è€…IDæ¡å½¢ç 
          JsBarcode(HisSrc.value, item.peVisitListRespVo.patientId, {
            fontSize: 18,
            width: 2,
            height: 30,
            margin: 4
          })
          item.peVisitListRespVo.HisImgUrl = HisSrc.value?.src || ''

          if (item.personalItemToPrintRespVoList && item.personalItemToPrintRespVoList.length > 0) {
            item.personalItemToPrintRespVoList.forEach((item1) => {
              if (item1.addItem) {
                noJiaxiangList.push(item1)
              } else {
                jiaxiangList.push(item1)
              }
              if (item1.peDeptClass == 'æ£€æŸ¥ç±»' && item1.applyNo) {
                JsBarcode(tijianSrc.value, item1.applyNo, {
                  displayValue: false,
                  fontSize: 18,
                  width: 2,
                  height: 28
                  // margin: 4
                })
                item1.imgUrl = tijianSrc.value?.src || ''
              }
            })
            item.jiaxiangList = jiaxiangList
            item.noJiaxiangList = noJiaxiangList
          }
        })
        mediaPrintData.value = printData
        console.log(mediaPrintData.value, 'æŒ‡å¼•å•æ‰“å°æ•°æ®')
        nextTick(() => {
          let style = document.createElement('style')
          style.innerHTML = `html, body {overflow: visible !important; height: 100% !important;}`
          document.head.appendChild(style)
          new VuePrintNext({
            el: '#printMe',
            previewOpenCallback: () => {
              document.head.removeChild(style)
            }
          })
        })
      }
    }
  })
}
// å¥åº·è¯æ•°æ®
const healthTabelData = ref({})
const print = () => {
  if (multipleSelection.value.length > 0) {
    printParams.value.peVisitReqVoList = multipleSelection.value
    let otherPrintParams = {
      flag: 0,
      peVisitReqVoList: multipleSelection.value
    }
    mediaPrintData.value = []
    let printData = []
    if (guidanceSheet.value) {
      // æŒ‡å¼•å•æ‰“å°
      selectPeGuidSheetPrint(printParams.value).then((res) => {
        // selectPeGuidSheetPrint({ peId: 'TJ10000030' }).then((res) => {
        // console.log(res, 'æŒ‡å¼•å•æ‰“å°æ•°æ®')
        if (res && res.length > 0) {
          printData = res
          if (printData.length > 0) {
            // zhiyindan
            // mediaPrintData.value = jsonTo3DArray(printData, 26)
            let jiaxiangList = []
            let noJiaxiangList = []

            printData.forEach((item) => {
              // æ‰‹å†™ç”µå­ç­¾å
              /* if (item.peVisitListRespVo.signValueString) {
                item.peVisitListRespVo.signValueString =
                  'data:image/png;base64,' + item.peVisitListRespVo.signValueString
              } */
              jiaxiangList = []
              noJiaxiangList = []
              JsBarcode(tijianSrc.value, item.peVisitListRespVo.peId, {
                // displayValue: false,
                fontSize: 18,
                width: 2,
                height: 30,
                margin: 4
              })
              item.peVisitListRespVo.imgUrl = tijianSrc.value?.src || ''
              // HISæ‚£è€…IDæ¡å½¢ç 
              JsBarcode(HisSrc.value, item.peVisitListRespVo.patientId, {
                fontSize: 18,
                width: 2,
                height: 30,
                margin: 4
              })
              item.peVisitListRespVo.HisImgUrl = HisSrc.value?.src || ''
              if (
                item.peVisitListRespVo.kindReminder &&
                item.peVisitListRespVo.kindReminder.includes('\r\n')
              ) {
                item.peVisitListRespVo.kindReminderList =
                  item.peVisitListRespVo.kindReminder.split('\r\n')
              } else {
                item.peVisitListRespVo.kindReminderList = []
              }
              if (
                item.personalItemToPrintRespVoList &&
                item.personalItemToPrintRespVoList.length > 0
              ) {
                item.personalItemToPrintRespVoList.forEach((item1) => {
                  if (item1.addItem) {
                    noJiaxiangList.push(item1)
                  } else {
                    jiaxiangList.push(item1)
                  }
                  if (item1.peDeptClass == 'æ£€æŸ¥ç±»' && item1.applyNo) {
                    JsBarcode(tijianSrc.value, item1.applyNo, {
                      displayValue: false,
                      fontSize: 18,
                      width: 2,
                      height: 28
                      // margin: 4
                    })
                    item1.imgUrl = tijianSrc.value?.src || ''
                  }
                })
                item.jiaxiangList = jiaxiangList
                item.noJiaxiangList = noJiaxiangList
              }
            })
            mediaPrintData.value = printData
            console.log(
              '%c Line:931 ğŸ¤ mediaPrintData.value',
              'color:#6ec1c2',
              mediaPrintData.value
            )
            console.log(mediaPrintData.value, 'æŒ‡å¼•å•æ‰“å°æ•°æ®')
            nextTick(() => {
              let style = document.createElement('style')
              style.innerHTML = `html, body {overflow: visible !important; height: 100% !important;}`
              document.head.appendChild(style)
              new VuePrintNext({
                el: '#printMe',
                // paperSize: 'A4' // è®¾ç½®çº¸å¼ å°ºå¯¸ä¸º A4
                // orientation: 'landscape', // è®¾ç½®çº¸å¼ æ–¹å‘ä¸ºæ¨ªå‘
                // preview: true, // å¯ç”¨é¢„è§ˆæ¨¡å¼
                // previewTitle: 'æ‰“å°æŒ‡å¼•å•', // è®¾ç½®å¼¹å‡ºçª—å£çš„æ ‡é¢˜
                // previewPrintBtnLabel: 'ç¡®è®¤æ‰“å°', // é¢„è§ˆæŒ‰é’®æ–‡æœ¬
                // paperSize: 'custom', // è®¾ç½®ä¸ºè‡ªå®šä¹‰å°ºå¯¸
                // customSize: {
                //   width: '210', // å®½åº¦
                //   height: 'auto', // é«˜åº¦
                //   unit: 'mm' // å•ä½ï¼šmmã€cmã€inã€px
                // }
                // extraCss: 'https://cdn.example.com/print-styles.css' // å¯é€‰ï¼šå¤–éƒ¨æ‰“å°æ ·å¼

                // windowMode: true // å¯ç”¨çª—å£æ¨¡å¼
                // defaultScale: 0.7, // è®¾ç½®é»˜è®¤ç¼©æ”¾æ¯”ä¾‹
                // standard: 'css', // ä½¿ç”¨ CSS æ§åˆ¶æ‰“å°æ ·å¼
                popTitle: 'é¡µç ', // å¼¹å‡ºçª—å£çš„æ ‡é¢˜ï¼Œå¯ä»¥ä¸ºç©ºå­—ç¬¦ä¸²ä»¥é¿å…æ˜¾ç¤ºç½‘å€æˆ–æ ‡é¢˜æ 
                // openCallback: (vm) => {
                //   // åœ¨æ‰“å°å‰éšè—å¤´éƒ¨å’Œåº•éƒ¨
                //   height = '290'
                //   const header = document.querySelector('.header')
                //   const footer = document.querySelector('.footer')
                //   if (header) header.style.display = 'none'
                //   if (footer) footer.style.display = 'none'
                //   document.getElementById('printMe').style = 'width: 100%; height: 100%'
                //   console.log('æ‰“å°å‰æ‰§è¡Œçš„æ“ä½œ', vm, header, footer)
                // },
                // previewBeforeOpenCallback: (vm) => {
                // height = '580'
                // // æ‰“å°åæ¢å¤æ˜¾ç¤º
                // const header = document.querySelector('.header')
                // const footer = document.querySelector('.footer')
                // if (header) header.style.display = ''
                // if (footer) footer.style.display = ''
                // document.getElementById('printMe').style = 'width: 100%; height: 100%;overflow-y: auto;'
                // console.log('æ‰“å°åæ‰§è¡Œçš„æ“ä½œ', vm, header, footer)

                // },
                previewOpenCallback: () => {
                  document.head.removeChild(style)
                }
              })
            })
          }
        }
      })
    } else if (printParams.value.labSheetTag) {
      // æ£€éªŒç”³è¯·å•æ‰“å°
      otherPrintParams.flag = 1
      printLabSheet(otherPrintParams).then((res) => {
        console.log(res, 'æ£€éªŒç”³è¯·å•æ‰“å°æ•°æ®')
        if (res && res.length > 0) {
          printData = res
        }
      })
      if (printData.length > 0) {
        // jianyan
      }
    } else if (printParams.value.personTag) {
      // ä¸ªäººæ¡ç æ‰“å°
      otherPrintParams.flag = 1
      printPersonalBar(otherPrintParams).then((res) => {
        console.log(res, 'ä¸ªäººæ¡ç æ‰“å°æ•°æ®')
        if (res && res.length > 0) {
          printData = res
        }
      })
      if (printData.length > 0) {
        // geren
      }
    } else if (printParams.value.labTag) {
      // æ£€éªŒæ¡ç æ‰“å°
      otherPrintParams.flag = 1
      printBarCode(otherPrintParams).then((res) => {
        console.log(res, 'æ£€éªŒæ¡ç æ‰“å°æ•°æ®')
        if (res && res.length > 0) {
          printData = res
        }
      })
      if (printData.length > 0) {
        // jianyantiaoma
      }
    } else if (printParams.value.examSheetTag) {
      // æ£€æŸ¥ç”³è¯·å•æ‰“å°
      otherPrintParams.flag = 1
      printExamSheet(otherPrintParams).then((res) => {
        console.log(res, 'æ£€æŸ¥ç”³è¯·å•æ‰“å°æ•°æ®')
        if (res && res.length > 0) {
          printData = res
        }
      })
      if (printData.length > 0) {
        // jiancha
      }
    } else if (medicalCertificate.value) {
      if (multipleSelection.value.length > 1) {
        ElMessage.error('å¥åº·è¯æ˜æš‚ä¸æ”¯æŒå¤šäººå‘˜æ‰¹é‡æ‰“å°')
        return
      } else {
        healthCertificateInfo({
          peId: multipleSelection.value[0].peId,
          peVisitId: multipleSelection.value[0].peVisitId
        }).then((res) => {
          if (res) {
            console.log(res, 'å¥åº·è¯æ˜æ‰“å°æ•°æ®')
            healthTabelData.value = res
            nextTick(() => {
              let style = document.createElement('style')
              style.innerHTML = `html, body {overflow: visible !important; height: 100% !important;}`
              document.head.appendChild(style)
              new VuePrintNext({
                el: '#health',
                previewOpenCallback: () => {
                  document.head.removeChild(style)
                }
              })
            })
            // setTimeout(() => {
            //   healthCertificateInfoUpload({
            //     peId: multipleSelection.value[0].peId,
            //     peVisitId: multipleSelection.value[0].peVisitId
            //   }).then((res) => {
            //     getPdf2()
            //   })
            // }, 500)
          }
        })
      }
    }
  } else {
    ElMessage.error('è¯·é€‰æ‹©è¦æ‰“å°çš„æ•°æ®')
    return
  }
}
const uploadPdf = () => {
  if (multipleSelection.value.length > 0) {
    if (multipleSelection.value.length > 1) {
      ElMessage.error('å¥åº·è¯æ˜æš‚ä¸æ”¯æŒå¤šäººå‘˜æ‰¹é‡ä¸Šä¼ ')
      return
    } else {
      healthCertificateInfo({
        peId: multipleSelection.value[0].peId,
        peVisitId: multipleSelection.value[0].peVisitId
      }).then((res) => {
        if (res) {
          console.log(res, 'å¥åº·è¯æ˜ä¸Šä¼ æ•°æ®')
          healthTabelData.value = res
          setTimeout(() => {
            healthCertificateInfoUpload({
              peId: multipleSelection.value[0].peId,
              peVisitId: multipleSelection.value[0].peVisitId
            }).then((res) => {
              getPdf2()
            })
          }, 500)
        }
      })
    }
  } else {
    ElMessage.error('è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ•°æ®')
    return
  }
}
const tableData = ref([])
const search = () => {
  if (time.value && time.value.length > 0) {
    searchParams.value.preBeginDate = time.value[0]
    searchParams.value.preEndDate = time.value[1]
  } else {
    searchParams.value.preBeginDate = ''
    searchParams.value.preEndDate = ''
  }
  selectPeGuidSheetList(searchParams.value).then((res) => {
    if (res && res.length > 0) {
      // tableData.value = splitArrayByLength(res, 23)
      // ä¸ºæ¯ä¸ªæ•°æ®é¡¹æ·»åŠ  uniqueId å±æ€§
      tableData.value = res.map((item) => {
        return {
          ...item,
          uniqueId: `${item.peId}-${item.peVisitId}`
        }
      })
    } else {
      tableData.value = []
    }
  })
}
/**
 * å°†JSONæ•°ç»„è½¬æ¢ä¸ºä¸‰ç»´æ•°ç»„
 * @param {Array} arr è¾“å…¥JSONæ•°ç»„
 * @returns {Array} ä¸‰ç»´æ•°ç»„ï¼Œç»“æ„å¦‚ä¸‹ï¼š
 * 1. ç¬¬ä¸€ç»´ï¼šæŒ‰peIdåˆ†ç»„
 * 2. ç¬¬äºŒç»´ï¼šæ¯ä¸ªpeIdç»„å†…åŒ…å«ä¸€ä¸ªåˆå¹¶åçš„æ•°ç»„
 * 3. ç¬¬ä¸‰ç»´ï¼šå°†åˆå¹¶åçš„æ•°ç»„æ‹†åˆ†æˆä¸è¶…è¿‡numæ¡çš„å­æ•°ç»„
 */
const jsonTo3DArray = (arr, num) => {
  // 1. æŒ‰peIdåˆ†ç»„
  const peIdMap = new Map()
  arr.forEach((item) => {
    if (!peIdMap.has(item.peId)) {
      peIdMap.set(item.peId, [])
    }
    peIdMap.get(item.peId).push(item)
  })

  // 2. å¤„ç†æ¯ä¸ªpeIdç»„
  const result = []
  for (const [peId, items] of peIdMap) {
    // 2.1 æŒ‰peDeptClassåˆ†ç»„å¹¶æ”¶é›†ç±»å‹æ ‡è®°
    const deptClassMap = new Map()
    const mergedArray = []

    items.forEach((item) => {
      if (!deptClassMap.has(item.peDeptClass)) {
        deptClassMap.set(item.peDeptClass, true)
        //mergedArray.push({ type: item.peDeptClass, peId: item.peId })
      }
      mergedArray.push(item)
    })

    // 3. æŒ‰numæ¡ä¸€ç»„æ‹†åˆ†
    const chunked = []
    for (let i = 0; i < mergedArray.length; i += num) {
      chunked.push(mergedArray.slice(i, i + num))
    }

    result.push(chunked)
  }

  return result
}

const splitArrayByLength = (arr, length) => {
  let result = []
  for (let i = 0; i < arr.length; i += length) {
    let end = Math.min(i + length, arr.length)
    result.push(arr.slice(i, end))
  }
  return result
}

// const htmlTitle = ref('ä½“æ£€æŠ¥å‘Š')
const loadingInstance = ref(null)
const loadingBox = ref(null)
const examSheet = ref(null)

// æ‰“å° PDF
const printPdf = (pdfData) => {
  printJS({
    printable: pdfData,
    base64: true,
    type: 'pdf',
    style: '@page { size: auto; margin: 0mm; }'
  })
}

// å¼€å§‹åŠ è½½åŠ¨ç”»
const startLoading = () => {
  loadingInstance.value = ElLoading.service({
    target: loadingBox.value,
    lock: true,
    text: 'ä¸Šä¼ å¥åº·è¯æ˜ä¸­...',
    spinner: 'el-icon-loading',
    background: 'rgba(255, 255, 255, 0.8)'
  })
}

// åœæ­¢åŠ è½½åŠ¨ç”»
const stopLoading = () => {
  if (loadingInstance.value) {
    loadingInstance.value.close()
    loadingInstance.value = null
  }
}

// ç”Ÿæˆ PDF å¹¶ä¸‹è½½æˆ–æ‰“å°
const getPdf2 = async () => {
  startLoading()
  // æ·»åŠ çŸ­æš‚çš„å»¶è¿Ÿï¼Œç¡®ä¿åŠ è½½åŠ¨ç”»æœ‰æœºä¼šæ˜¾ç¤º
  await new Promise((resolve) => setTimeout(resolve, 100))
  const element = examSheet.value
  const pages = element.querySelectorAll('.page')
  const pdf = new JsPDF('p', 'pt', 'a4')
  let position = 0
  const promises = []

  for (let i = 0; i < pages.length; i++) {
    const page = pages[i]
    const promise = html2Canvas(page, {
      allowTaint: true,
      taintTest: false,
      useCORS: true,
      dpi: window.devicePixelRatio * 4,
      scale: 4
    }).then(async (canvas) => {
      const imgData = canvas.toDataURL('image/jpeg', 1.0)
      const imgWidth = 585.28
      const imgHeight = (canvas.height * imgWidth) / canvas.width
      if (i > 0) {
        pdf.addPage()
        position = 0
      }
      pdf.addImage(imgData, 'JPEG', 5, position, imgWidth, imgHeight)
      if (i === pages.length - 1) {
        // if (isPrint) {
        const pdfDataUrl = pdf.output('datauristring')
        const base64String = pdfDataUrl.split(',')[1] // æå–çº¯ Base64 å­—ç¬¦ä¸²
        // console.log('pdfDataUrl', pdfDataUrl)

        const pdfFile = base64PdfToFile(pdfDataUrl, `${multipleSelection.value[0].name}.pdf`)
        // éªŒè¯ç»“æœ
        console.log(pdfFile) // true
        console.log(pdfFile.name) // "report.pdf"
        console.log(pdfFile.type) // "application/pdf"
        if (!pdfFile) {
          console.error('pdfFile is empty')
          return
        }

        // æ‰“å°æ•°æ®ï¼Œç¡®ä¿æ˜¯æœ€æ–°çš„
        console.log('Uploading PDF:', pdfFile)
        try {
          const formData = new FormData()
          formData.append('file', pdfFile)
          formData.append('reportId', multipleSelection.value[0].peId)

          // å‘é€è¯·æ±‚
          const response = await upPdfEmployees(formData).then((res) => {
            if (res.code === 200) {
              ElMessage.success('ä¸Šä¼ å¥åº·è¯æ˜æˆåŠŸ')
            }
          })
          console.log('Upload success:', response)
          ElMessage.success('ä¸Šä¼ å¥åº·è¯æ˜æˆåŠŸ')
        } catch (error) {
          console.error('Upload failed:', error)
          ElMessage.error('ä¸Šä¼ å¥åº·è¯æ˜å¤±è´¥')
        }
        // upPdfEmployees({
        //   file: pdfFile,
        //   reportId: multipleSelection.value[0].peId
        // }).then((res) => {
        //   ElMessage.success('ä¸Šä¼ å¥åº·è¯æ˜æˆåŠŸ')
        // })
        // printPdf(base64String)
        // } else {
        //   pdf.save(htmlTitle.value + '.pdf')
        // }
      }
    })
    promises.push(promise)
  }

  try {
    await Promise.all(promises)
  } catch (error) {
    console.error('Error generating images:', error)
  } finally {
    stopLoading()
  }
}
/**
 * å°†Base64 PDFå­—ç¬¦ä¸²è½¬æ¢ä¸ºFileå¯¹è±¡
 * @param {string} base64Pdf - åŒ…å«MIMEç±»å‹çš„Base64 PDFå­—ç¬¦ä¸²ï¼ˆå¦‚ï¼š"data:application/pdf;base64,JVBERi0xLjQK..."ï¼‰
 * @param {string} [fileName="document.pdf"] - è‡ªå®šä¹‰æ–‡ä»¶å
 * @returns {File} PDFæ–‡ä»¶å¯¹è±¡
 */
const base64PdfToFile = (base64Pdf, fileName = 'document.pdf') => {
  // å‚æ•°æ ¡éªŒ
  if (typeof base64Pdf !== 'string' || !base64Pdf.includes(';base64,')) {
    throw new Error('Invalid Base64 PDF format')
  }

  // æå–MIMEç±»å‹å’Œçº¯Base64æ•°æ®
  const [metadata, base64Data] = base64Pdf.split(',')
  const mimeType = metadata.match(/:(.*?);/)[1]

  // éªŒè¯PDFç±»å‹
  if (mimeType !== 'application/pdf') {
    console.warn(`Expected PDF type but got ${mimeType}`)
  }

  // è§£ç å¹¶è½¬æ¢
  const binaryData = atob(base64Data)
  const arrayBuffer = new ArrayBuffer(binaryData.length)
  const uint8Array = new Uint8Array(arrayBuffer)

  for (let i = 0; i < binaryData.length; i++) {
    uint8Array[i] = binaryData.charCodeAt(i)
  }

  // åˆ›å»ºFileå¯¹è±¡
  return new File([uint8Array], fileName, {
    type: 'application/pdf',
    lastModified: Date.now()
  })
}

onMounted(async () => {
  petypeNameList.value = await queryDictByConfig({
    dictType: 'ä½“æ£€ç±»å‹å­—å…¸',
    cons: 'dict_name:ä½“æ£€ç±»å‹'
  })
  search()
  initPlugin()
})

defineExpose({ PrintZhiYinDan })
const writeSign = ref<string | null>(null)
const SignUrl = ref<string>('')

import { onMounted, ref } from 'vue'
import PluginNSV from '@/utils/writeSign/js-NSV'
import { display } from 'html2canvas/dist/types/css/property-descriptors/display'

interface PluginInstance {
  DestroyPlugin?(): void
  InitPlugin(callback: (state: number) => void): void
  setPenSizeRange(min: number, max: number, callback: any): void
  setPenColor(r: number, g: number, b: number, callback: any): void
  onConfirm: (() => void) | null
  onClear: (() => void) | null
  onCancel: (() => void) | null
  NoSigned: (() => void) | null
  beginSign(callback: (state: number, args: any) => void): void
  endSign(callback: (state: number, args: any) => void): void
  clearSign(callback: (state: number, args: any) => void): void
  saveSignToBase64(x: number, y: number, callback: (state: number, args: string[]) => void): void
}

let plugin: PluginInstance | null = null

function debugPrint(text: string) {
  console.log(`%c DebugPrint: ${text}`, 'color:#fca650')
}

function initPlugin() {
  if (plugin) {
    plugin.DestroyPlugin?.()
  }

  plugin = new PluginNSV()

  plugin.InitPlugin((state) => {
    if (state === 1) {
      plugin?.setPenSizeRange(3, 9, null)
      plugin?.setPenColor(0, 0, 0, null)
      // document.getElementById('label_state')!.innerText = 'æœåŠ¡è¿æ¥æˆåŠŸ.'
      debugPrint('initialize plugin OK.')
    } else {
      // document.getElementById('label_state')!.innerText = 'è¿æ¥å¤±è´¥.'
      debugPrint('initialize plugin fails.')
    }
  })

  plugin.onConfirm = () => {
    saveSignToBase64()
    endSign()
  }

  plugin.onClear = () => {
    clearSign()
  }

  plugin.onCancel = () => {
    endSign()
  }

  plugin.NoSigned = () => {
    if (plugin) {
      plugin.NoSign((state, args) => {
        if (state) {
          debugPrint('NoSign OK')
        } else {
          debugPrint('NoSign error: ' + args[0])
        }
      })
    }
  }
}

function clearSign() {
  if (plugin) {
    plugin.clearSign((state, args) => {
      if (state) {
        debugPrint('clearSign OK')
      } else {
        debugPrint('clearSign error: ' + args[0])
      }
    })
  }
}

function beginSign() {
  // document.getElementById('img_sign_result')!.src = ''
  if (multipleSelection.value.length < 1) {
    ElMessage.error('è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªå—æ£€äººå‘˜')
    return
  }
  if (multipleSelection.value.length > 1) {
    ElMessage.error('æœ€å¤šåªèƒ½é€‰æ‹©ä¸€ä¸ªå—æ£€äººå‘˜')
    return
  }

  if (plugin) {
    plugin.beginSign((state, args) => {
      if (state) {
        plugin?.setDisplayMapMode(1, state)
        debugPrint('beginSign OK')
      } else {
        debugPrint('beginSign error: ' + args[0])
      }
    })
  }
}

function endSign() {
  if (plugin) {
    plugin.endSign((state, args) => {
      if (state) {
        debugPrint('endSign OK')
      } else {
        debugPrint('endSign error: ' + args[0])
      }
    })
  }
}

function saveSignToBase64() {
  if (!plugin) {
    ElMessage.error('ç­¾åæœåŠ¡æœªåˆå§‹åŒ–')
    return
  }

  plugin.saveSignToBase64(0, 0, (state, args) => {
    if (state && args.length > 0) {
      const imgBase64 = args[0]
      writeSign.value = imgBase64
      SignUrl.value = 'data:image/png;base64,' + imgBase64

      if (multipleSelection.value?.[0]?.peId && multipleSelection.value[0]?.peVisitId) {
        SaveSign(SignUrl.value)
      } else {
        ElMessage.error('è¯·é€‰æ‹©æœ‰æ•ˆçš„å—æ£€äººå‘˜')
      }
    } else {
      debugPrint('saveSignToBase64 error: ' + args[0])
    }
  })
}
// åœ¨ script setup ä¸­æ·»åŠ 
watch(SignUrl, (newVal, oldVal) => {
  if (newVal && newVal.length > 0) {
  }
})

function destroyPlugin() {
  if (plugin && plugin.DestroyPlugin) {
    plugin.DestroyPlugin()
  }
  plugin = null
}

onBeforeRouteLeave((to, from, next) => {
  destroyPlugin()
  multipleSelection.value = []
  next()
})

onBeforeUnmount(() => {
  destroyPlugin()
  multipleSelection.value = []
})

// å¦‚æœç»„ä»¶ä½¿ç”¨äº† keep-aliveï¼Œé‡æ–°æ¿€æ´»æ—¶å†æ¬¡åˆå§‹åŒ–
onActivated(() => {
  initPlugin()
})

const SaveSign = async (sign) => {
  if (!multipleSelection.value || multipleSelection.value.length === 0) {
    ElMessage.error('è¯·é€‰æ‹©å—æ£€äººå‘˜')
    return
  }

  const selected = multipleSelection.value[0]
  if (!selected.peId || !selected.peVisitId) {
    ElMessage.error('è¯·é€‰æ‹©æœ‰æ•ˆçš„å—æ£€äººå‘˜')
    return
  }

  await peSign({
    peId: selected.peId,
    peVisitId: selected.peVisitId,
    signValue: sign
  }).then((res) => {
    if (res) {
      ElMessage.success('ç­¾åæˆåŠŸ')
      search()
    }
  })
}

//æ ¹æ®ä½“æ£€ç±»å‹ç­›é€‰å¥—é¤åˆ†ç±»
const changePeType = (val) => {
  search()
}
const petypeNameList = ref<any>([])
const unitInfo = ref<any>({})
// æ ¹æ®å•ä½ç¼–ç æŸ¥è¯¢æŠ¥é“äººä¿¡æ¯
// const searchByUnitCode = async () => {
//   if (formInfo.unitCode) {
//     // let res = await getPeUnitDict({
//     let res = await getUnitInfo({
//       unitCode: formInfo.unitCode
//     })
//     if (res && res.unitName) {
//       formInfo.unitName = res.unitName
//       formInfo.unitCode = res.unitCode
//       formInfo.unitVisitId = res.unitVisitId
//       unitInfo.value = res
//     } else {
//       formInfo.unitName = ''
//       formInfo.unitCode = ''
//       formInfo.unitVisitId = ''
//       unitInfo.value = {}
//       ElMessage.warning('æœªæŸ¥è¯¢åˆ°é¢„çº¦ä¿¡æ¯')
//     }
//     // await getList()
//   }
// }
const selectUnitCodeVisiable = ref(false)
// ç‚¹å‡»å•ä½rowæ•°æ®è¿›è¡Œèµ‹å€¼æ“ä½œ
const selectUnitCodeClick = async (row) => {
  searchParams.value.unitCode = row.unitCode
  searchParams.value.unitName = row.unitName
  searchParams.value.unitVisitId = row.unitVisitId
  unitInfo.value = row
  selectUnitCodeVisiable.value = false
  // await getList()
}
const unitCodeList = ref<any>([])
const keyWord = ref('')
// ç‚¹å‡»æŒ‰é’®æŸ¥è¯¢å•ä½ä»£ç å’Œåç§°å¹¶æ‰“å¼€å¼¹æ¡†
const onFocusUnitCode = async () => {
  keyWord.value = ''
  handleQueryItem()
  selectUnitCodeVisiable.value = true
  nextTick(() => {
    queryInput.value.focus()
  })
}
//æ ¹æ®å•ä½ä»£ç è¿‡æ»¤å•ä½åˆ—è¡¨
const handleQueryItem = async () => {
  unitCodeList.value = await getPeUnitList({
    // unitCodeList.value = await getUnitInfo({
    input: keyWord.value
    // unitCode: keyWord.value
  })
}

const handleRowClick = (row, column, event) => {
  // åˆ‡æ¢é€‰ä¸­çŠ¶æ€
  multipleTableRef.value?.toggleRowSelection(row)
}
</script>
<style lang="scss" scoped>
.per_report {
  background-color: #f5f7f9;
  font-size: 14px;
  font-weight: 400;
  color: #333333;
  width: 100%;
  height: calc(100vh - 54px);
  overflow: hidden;
  padding: 40px 8px 0;
  box-sizing: border-box;
  .report_search {
    .search1 {
      padding: 16px 24px;
      width: 100%;
      display: flex;
      align-items: center;
      background-color: #fff;
      .div1 {
        margin-right: 12px;
        display: flex;
        align-items: center;
        .span1 {
          color: #333333;
          font-size: 14px;
          display: inline-block;
        }
        .el-button {
          background-color: #3473d1;
          color: #fff;
          padding: 0% 24px;
          border-color: #3473d1;
        }
        .read {
          color: #3473d1;
          border-color: #3473d1;
          background-color: #fff;
          img {
            width: 16px;
            height: 16px;
            margin-right: 4px;
          }
        }
        .delReport {
          color: #ed2226;
          border-color: #ed2226;
          background-color: #fff;
        }
      }
    }
  }
  .report_table {
    display: flex;
    justify-content: space-between;
    .table_item {
      width: 100%;
      height: calc(100vh - 218px);
      background-color: #fff;
      margin-top: 8px;
      overflow-x: auto;
      // display: flex;
      align-items: center;
      padding: 8px;
      .list_table {
        // margin: 0 8px;
        width: 100%;
        /* padding: 12px; */
        :deep(.el-checkbox-group) {
          display: flex;
          flex-direction: column;
          flex-wrap: wrap;
          height: calc(100vh - 257px);
          gap: 9px;
          column-gap: 19px;
          align-content: flex-start;
        }
      }
    }
    .heard_title {
      height: 40px;
      line-height: 40px;
      /* padding-left: 20px; */
      /* margin-bottom: 11px; */
      border-bottom: 1px solid #c5dcff;
      span {
        display: inline-block;
        width: auto;
        height: 40px;
        padding: 0 20px;
        text-align: center;
        /* border-bottom: 2px solid #3473d1; */
        color: #3473d1;
        font-weight: bold;
      }
    }
  }
}
.print_content {
  page-break-after: always; /* æ¯å—å†…å®¹åå¼ºåˆ¶åˆ†é¡µ */
  break-inside: avoid; /* é˜²æ­¢å†…å®¹å—å†…éƒ¨åˆ†é¡µ */
  width: 210mm;
  height: 290mm;

  .print_heard {
    .hos_t {
      display: flex;
      justify-content: center;
      height: 40px;
      align-items: center;
      font-size: 26px;
      font-weight: bold;
      position: relative;
      img {
        position: absolute;
        left: 0px;
        top: 0;
      }
    }
    .title {
      width: 100%;
      font-size: 20px;
      text-align: center;
      line-height: 40px;
      height: 40px;
      font-weight: bold;
    }
    .per_msg {
      position: relative;
      font-family: 'SimSun', 'STSong', serif;
      .el-row {
        .el-col {
          overflow: hidden;
          white-space: nowrap;
          font-size: 14px;
        }
      }
      img {
        width: 80px;
        height: 110px;
        position: absolute;
        right: 20px;
        top: -54px;
      }
    }
    .tishi {
      border-top: #333333 1px solid;

      .tishi_in {
        width: 100%;
        font-size: 14px;
        display: flex;
        /* border-top: 2px solid #333333; */
        border-bottom: 1px solid #333333;
        /* height: 64px; */
      }
      .tishi_in:last-child {
        border-top: none;

        border-bottom: none;
      }
      .tishi_t {
        width: 120px;
        /* line-height: 30px; */
        color: #333333;
        font-weight: bold;
        /* border-right: #333333 1px solid; */
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .tishi_con {
        width: calc(100% - 121px);
        color: #666666;
        word-break: break-all;
        overflow: hidden;
        /* line-height: 20px; */
        .el-row {
          line-height: 20px;
          height: 20px;
          .el-col:first-child {
            padding-left: 8px;
          }
        }
      }
    }
  }
  .print_con {
    .table {
      width: 100%;
      height: calc(290mm - 300px);
      overflow: hidden !important;
      .table_t {
        width: 100%;
        height: 30px;
        line-height: 30px;
        border-top: 1px solid #333333;
        border-bottom: 1px solid #333333;
        font-size: 14px;
        .neirong {
          /* border-bottom: #333333 1px solid; */
          .el-row {
            line-height: 36px;
            height: 36px;
          }
          .el-col {
            line-height: 36px;
            height: 36px;
            white-space: normal;
            overflow: hidden;
          }
          .weizhi {
            font-weight: bold;
            font-size: 16px;
          }
          .el-col {
            overflow: hidden;
            height: 36px;
            display: block;
            display: -webkit-box;
            overflow: hidden;
            text-overflow: ellipsis;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
          }
          .col_LH {
            font-size: 12px;
            line-height: 18px;
          }
        }
        .neirong:last-child {
          border-bottom: none;
        }
      }
    }
    .b_msg {
      width: 100%;
      text-align: center;
      height: 60px;
      /* border-top: #333333 1px solid; */
      /* border-bottom: #333333 1px solid; */

      font-size: 14px;
      color: #333333;
      position: relative;
      .tishi_in {
        width: 100%;
        font-size: 14px;
        display: flex;
        /* border-top: 1px solid #333333; */
        border-bottom: 1px solid #333333;
        height: 30px;
      }
      .tishi_t {
        width: 120px;
        height: 30px;
        line-height: 30px;
        color: #333333;
        font-weight: bold;
        /* border-right: #333333 1px solid; */
        text-align: center;
      }
      .b_c {
        height: 30px;
        line-height: 30px;
      }
      .b_p {
        position: absolute;
        top: 0px;
        right: 6px;
      }
    }
    .bot {
      display: flex;
      border-bottom: #333333 1px solid;
      width: 100%;
      .bot_l {
        width: 120px;
        height: 96px;
        text-align: center;
        font-weight: bold;
        padding-top: 15px;
        font-size: 16px;
        border-right: #333333 1px solid;
      }
      .bot_r {
        width: 100%;
        height: 96px;
        .el-row {
          height: 30px;
          line-height: 30px;
          font-size: 14px;
          color: #333333;
        }
      }
    }
  }
}
:deep(.pdfVisible) {
  margin: 0;
  .el-dialog {
    margin: 0 !important;
  }
  .el-dialog__body {
    padding: 0 !important;
  }
}
#health {
  width: 210mm;
  height: 290mm;
  .health_page {
    width: 100%;
    height: 100%;
    padding: 10px 0px;
    background-color: #fff;
    .health_h {
      display: flex;
      justify-content: space-between;
      font-size: 16px;
      height: 40px;
      align-items: center;
      .h_div1 {
      }
      .h_div2 {
        font-weight: bold;
      }
    }
    .health_t {
      width: 100%;
      height: 40px;
      text-align: center;
      line-height: 40px;
      font-size: 22px;
    }
    .health_per {
      border-right: #333333 1px solid;
      div {
        height: 40px;
        width: 100%;
      }
      .per_yb {
        display: flex;
        align-items: center;
        padding-left: 8px;
        font-size: 18px;
        border-top: 1px solid #333333;
        border-left: #333333 1px solid;
        /* border-right: #333333 1px solid; */
      }
      .per_na {
        width: 100%;
        display: flex;
        align-items: center;
        /* padding-left: 8px; */
        font-size: 14px;
        border-top: #333333 1px solid;
        position: relative;
        div {
          padding-left: 8px;
          border-left: #333333 1px solid;
          line-height: 40px;
          border-bottom: #333333 1px solid;
        }
        .div1 {
          width: 15%;
        }
        .div2 {
          width: 25%;
        }
        .div3 {
          width: 15%;
        }
        .div4 {
          width: calc(25% + 1px);
          padding-right: 1px;
          border-right: #333333 1px solid;
        }
        img {
          width: 80px;
          height: 110px;
          text-align: center;
          position: absolute;
          right: 38px;
          top: 5px;
        }
      }
      .per_sfz {
        width: 100%;
        display: flex;
        align-items: center;
        /* padding-left: 8px; */
        font-size: 14px;
        .div1 {
          width: 15%;
          border-left: #333333 1px solid;
          line-height: 40px;
          border-bottom: #333333 1px solid;
          padding-left: 8px;
        }
        .div2 {
          width: calc(65% + 1px);
          line-height: 40px;
          border-bottom: #333333 1px solid;
          padding-left: 8px;
          padding-right: 1px;
          border-left: #333333 1px solid;
          border-right: #333333 1px solid;
        }
      }
      .per_jk {
        width: calc(80% + 1px);
        display: flex;
        align-items: center;
        padding-left: 8px;
        font-size: 18px;
        border-left: #333333 1px solid;
        border-right: #333333 1px solid;
      }
    }
    .div_table {
      width: 100%;
      border-top: #333333 1px solid;
      height: calc(290mm - 360px);
      .data_table {
        width: 100%;
        .tr1 {
          height: 36px;
          width: 100%;
          text-align: center;
          border-bottom: #333333 1px solid;
          .td1 {
            width: 35%;
            border-right: #333333 1px solid;
            border-left: #333333 1px solid;
          }
          .td2 {
            width: 45%;
          }
          .td3 {
            width: 8%;
            border-right: #333333 1px solid;
            border-left: #333333 1px solid;
          }
          .td4 {
            width: 12%;
            border-right: #333333 1px solid;
          }
        }
        .tr2 {
          height: 36px;
          width: 100%;
          text-align: center;
          border-bottom: #333333 1px solid;
          .td1 {
            width: 7.5%;
            border-right: #333333 1px solid;
          }
          .td2 {
            width: 7.5%;
            border-right: #333333 1px solid;
          }
          .td3 {
            width: 30%;
            border-right: #333333 1px solid;
          }
        }
        .tr3 {
          height: 50px;
          width: 100%;
          text-align: center;
          border-bottom: #333333 1px solid;
          .td1 {
            text-align: left;
            width: 35%;
            border-right: #333333 1px solid;
            border-left: #333333 1px solid;
            overflow: hidden;
            text-align: center;
          }
          .td2 {
            width: 7.5%;
            border-right: #333333 1px solid;
          }
          .td3 {
            width: 7.5%;
            border-right: #333333 1px solid;
          }
          .td4 {
            width: 30%;
            border-right: #333333 1px solid;
          }
          .td5 {
            width: 8%;
            border-right: #333333 1px solid;
            border-left: #333333 1px solid;
            text-align: center;
            img {
              width: 60px;
              height: 23px;
            }
          }
          .td6 {
            width: 12%;
            border-right: #333333 1px solid;
          }
        }
      }
    }
    .health_bz {
      width: 100%;
      line-height: 22px;
      font-size: 14px;
    }
    .health_qz {
      display: flex;
      justify-content: space-between;
      div {
        display: flex;
        align-items: center;
        padding: 0 20px;
        height: 80px;
        font-size: 14px;
        text-align: center;
      }
    }
  }
}
</style>
<style>
@media print {
  @page {
    height: 100%;
    width: 100%;
    padding: 10px 20px;
    margin: 15px;
  }
  html,
  body {
    height: 100% !important;
    width: 100% !important;
    overflow: visible !important;
  }
  .print_content {
    page-break-after: auto;
    /* padding: 0 20px; */
  }
  /* æ ·å¼åç§°è¦å”¯ä¸€é¿å…åŠŸèƒ½æ ·å¼å†²çª */
  .print_heard {
    /* position: fixed;
    top: 0;
    width: 100%;
    height: 152px;
    background: white;
    z-index: 0; */
  }
  /* æ ·å¼åç§°è¦å”¯ä¸€é¿å…åŠŸèƒ½æ ·å¼å†²çª */
  .print_con {
    /* page-break-after: always; */
    /* margin-top: 152px; */
  }
  /* é¿å…æœ€åä¸€é¡µå¤šå‡ºç©ºç™½ */
  .print_con:last-child {
    page-break-after: auto;
  }
  /* å…¶ä»–æ‰“å°æ ·å¼è°ƒæ•´ */
  /* .no-print {
    display: none !important;
  } */
}

.selectBtn {
  margin-left: 0;
  .el-button {
    position: relative;
    top: 0px;
    margin-left: -1px;
    background: #f5f7fa !important;
    color: #999 !important;
    border-radius: 0px 4px 4px 0px !important;
  }
}
</style>
